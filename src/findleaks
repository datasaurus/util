#!/usr/bin/awk -f
#
#	This script reads output from the diagnostic allocators.  It reports
#	on any leaks it finds.  A leak is an allocation that is never freed.
# 
# Copyright (c) 2008 Gordon D. Carrie
#
 * Licensed under the Open Software License version 3.0
#
# Please send feedback to user0@tkgeomap.org
#
# $Id: findleaks,v 1.1 2008/10/30 16:25:33 gcarrie Exp $

/(0x)?[0-9]+.* allocated / {
    cnt[$1]++
}
/(0x)?[0-9]+.* freed / {
    cnt[$1]--
}
END {
    for (a in cnt) {
	if (cnt[a] > 0) {
	    printf "Leak at %s\n", a
	}
    }
}
